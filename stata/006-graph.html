<!DOCTYPE html>
<html>

<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-F8SLV521P4"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-F8SLV521P4');
    </script>
    <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>繪圖</title>
    <link rel="stylesheet" type="text/css" href="../assets/style/main.css">
    <script src="https://astalsi401.github.io/jQuery/jquery-1.9.0.min.js"></script>
</head>

<body>
    <div id="top"></div>
    <div id="stataPage" class="sidebar"></div>
    <div id="plate"></div>
    <div class="largePic">
        <div id="pic"></div>
    </div>
    <div class="container">
        <h2 data-type="title_1" id="006">006. 繪圖</h2>
        <div id="showCode">本頁do file</div>
        <pre id="code">
clear
quietly input str14 state ur 
 
cap drop ur0  /*如果有ur0的話就拋棄，沒有則不做動作*/
recode ur (2.0/3.9=1 "2.0-3.9") (4.0/5.9=2 "4.0-5.9") /// 
    (6.0/7.9=3 "6.0-7.9") (8.0/9.9=4 "8.0-9.9") ,generate(ur0)   /*將ur重新編碼為ur0*/
lab var ur0 "class interval"
tab ur0

preserve /*建立保存點*/
collapse (count) ur, by (ur0)
lab def ur0 1 "2.0-3.9" 2 "4.0-5.9" 3 "6.0-7.9" 4 "8.0-9.9", modify
lab val ur0 ur0
lab var ur "Frequency"
lab var ur0 "Class Interval"
list
twoway (sca ur ur0, c(1)), xlabel(1(1)4, valuelabel angle(0))
graph export "line01.png", replace
restore /*回到保存點*/

graph bar (count) ur, over(ur0, label(angle(45))) /// /*將count換成percent就會變為百分比*/
    ylabel(0(5)20, angle(0)) nofill ///
    ytitle("Frequency") b1title("Class Interval") ///
    blabel(bar, format(%4.0f)) legend(off)
graph export "bar01.png", replace

graph pie, over(ur0) plabel(_all percent) title(Class Interval) legend(cols(4))
graph export "pie01.png", replace

clear
input year crate
1987 612.5
1988 640.6
1989 666.9
1990 729.6
1991 758.2
1992 757.7
1993 747.1
1994 713.6
1995 684.5
1996 636.6
1997 611.0
1998 567.6
1999 523.0
2000 506.5
2001 504.5
2002 494.4
2003 475.8
2004 463.2
2005 469.0
2006 479.3
2007 471.8
2008 458.6
2009 431.9
2010 403.6
end
lab var year "Year"
twoway (scatter crate year, c(l)), /// /*c(l) 用線將點連起來*/
    ylabel(, angle(0))              ///
    ytitle("Violent Crime Rate")
graph export "sca01.png", replace

clear
input gender x
0 5
0 2
0 7
0 9
0 3
0 4
0 3
0 1
0 3
0 8
1 3
1 5
1 7
1 4
1 5
1 6
1 7
1 6
1 5
1 4
end
lab var gender "gender"
lab def gender 0 "Male" 1 "Female", modify
lab val gender gender
graph box x, over (gender) ytitle("抽菸次數/週") b1title("性別") 
                                              /*b1title: b1=下排第一層*/
graph export "box01.png", replace
</pre>
        <div class="block">
            <p>輸入資料</p>
            <pre id="stlog-11" class="stlog"><samp>
<span class="stinp">. clear</span>
<span class="stinp">. quietly input str14 state ur </span>
<span class="stinp">. </span>
<span class="stinp">. cap drop ur0  <span class="stcmt">/*如果有ur0的話就拋棄，沒有則不做動作*/</span></span>
<span class="stinp">. recode ur (2.0/3.9=1 "2.0-3.9") (4.0/5.9=2 "4.0-5.9") <span class="stcmt">/// </span>
                 &gt;           (6.0/7.9=3 "6.0-7.9") (8.0/9.9=4 "8.0-9.9") ,generate(ur0)   <span class="stcmt">/*將ur重新編碼為ur0*/</span></span>
(34 differences between ur and ur0)

<span class="stinp">. lab var ur0 "class interval"</span>

<span class="stinp">. tab ur0</span>

      class |
   interval |      Freq.     Percent        Cum.
------------+-----------------------------------
    2.0-3.9 |<span class="stres">          5       14.71       14.71</span>
    4.0-5.9 |<span class="stres">         20       58.82       73.53</span>
    6.0-7.9 |<span class="stres">          8       23.53       97.06</span>
    8.0-9.9 |<span class="stres">          1        2.94      100.00</span>
------------+-----------------------------------
      Total |<span class="stres">         34      100.00</span>
    </samp></pre>
        </div>
        <div class="block">
            <h3 data-type="title_2" id="6-1">折線圖</h3>
            <pre id="stlog-12" class="stlog"><samp>
<span class="stinp">. preserve <span class="stcmt">/*建立保存點*/</span></span>
<span class="stinp">. collapse (count) ur, by (ur0)</span>
<span class="stinp">. lab def ur0 1 "2.0-3.9" 2 "4.0-5.9" 3 "6.0-7.9" 4 "8.0-9.9", modify</span>
<span class="stinp">. lab val ur0 ur0</span>
<span class="stinp">. lab var ur "Frequency"</span>
<span class="stinp">. lab var ur0 "Class Interval"</span>
<span class="stinp">. list</span>
     +--------------+
     | <span class="stres">    ur0   ur </span>|
     |--------------|
  1. | <span class="stres">2.0-3.9    5 </span>|
  2. | <span class="stres">4.0-5.9   20 </span>|
  3. | <span class="stres">6.0-7.9    8 </span>|
  4. | <span class="stres">8.0-9.9    1 </span>|
     +--------------+
<span class="stinp">. twoway (sca ur ur0, c(1)), xlabel(1(1)4, valuelabel angle(0))</span>
(note:  named style 1 not found in class connectstyle, default attributes used)
<span class="stinp">. graph export "line01.png", replace</span>
(file line01.png written in PNG format)
<span class="stinp">. restore <span class="stcmt">/*回到保存點*/</span></span>
    </samp></pre>
            <div class="img-block">
                <img id="line01" src="" alt="">
            </div>
        </div>
        <div class="block">
            <h3 data-type="title_2" id="6-2">柱狀圖</h3>
            <pre id="stlog-13" class="stlog"><samp>
<span class="stinp">. graph bar (count) ur, over(ur0, label(angle(45))) <span class="stcmt">/// /*將count換成percent就會變為百分比*/</span>
&gt;       ylabel(0(5)20, angle(0)) nofill <span class="stcmt">///</span>
&gt;       ytitle("Frequency") b1title("Class Interval") <span class="stcmt">///</span>
&gt;       blabel(bar, format(%4.0f)) legend(off)</span>
<span class="stinp">. graph export "bar01.png", replace</span>
(file bar01.png written in PNG format)
    </samp></pre>
            <div class="img-block">
                <img id="bar01" src="" alt="">
            </div>
        </div>
        <div class="block">
            <h3 data-type="title_2" id="6-3">圓餅圖</h3>
            <pre id="stlog-14" class="stlog"><samp>
<span class="stinp">. graph pie, over(ur0) plabel(_all percent) title(Class Interval) legend(cols(4))</span>
<span class="stinp">. graph export "pie01.png", replace</span>
(file pie01.png written in PNG format)
    </samp></pre>
            <div class="img-block">
                <img id="pie01" src="" alt="">
            </div>
        </div>
        <div class="block">
            <h3 data-type="title_2" id="6-4">散點圖</h3>
            <pre id="stlog-15" class="stlog"><samp>
<span class="stinp">. clear</span>
<span class="stinp">. input year crate</span>
      year crate
   1. 1987 612.5
   2. 1988 640.6
   3. 1989 666.9
   4. 1990 729.6
   5. 1991 758.2
   6. 1992 757.7
   7. 1993 747.1
   8. 1994 713.6
   9. 1995 684.5
  10. 1996 636.6
  11. 1997 611.0
  12. 1998 567.6
  13. 1999 523.0
  14. 2000 506.5
  15. 2001 504.5
  16. 2002 494.4
  17. 2003 475.8
  18. 2004 463.2
  19. 2005 469.0
  20. 2006 479.3
  21. 2007 471.8
  22. 2008 458.6
  23. 2009 431.9
  24. 2010 403.6
  25. end
<span class="stinp">. lab var year "Year"</span>
<span class="stinp">. twoway (scatter crate year, c(l)), <span class="stcmt">/// /*c(l) 用線將點連起來*/</span>
&gt;    ylabel(, angle(0))              <span class="stcmt">///</span>
&gt;    ytitle("Violent Crime Rate")</span>
<span class="stinp">.  graph export "sca01.png", replace</span>
(file sca01.png written in PNG format)
    </samp></pre>
            <div class="img-block">
                <img id="sca01" src="" alt="">
            </div>
        </div>
        <div class="block">
            <h3 data-type="title_2" id="6-5">盒狀圖</h3>
            <pre id="stlog-16" class="stlog"><samp>
<span class="stinp">. clear</span>
<span class="stinp">. input gender x</span>
    gender x
 1. 0 5
 2. 0 2
 3. 0 7
 4. 0 9
 5. 0 3
 6. 0 4
 7. 0 3
 8. 0 1
 9. 0 3
10. 0 8
11. 1 3
12. 1 5
13. 1 7
14. 1 4
15. 1 5
16. 1 6
17. 1 7
18. 1 6
19. 1 5
20. 1 4
21. end
<span class="stinp">. lab var gender "gender"</span>
<span class="stinp">. lab def gender 0 "Male" 1 "Female", modify</span>
<span class="stinp">. lab val gender gender</span>
<span class="stinp">. graph box x, over (gender) ytitle("抽菸次數/週") b1title("性別") </span>
<span class="stinp">.                           <span class="stcmt">/*b1title: b1=下排第一層*/</span></span>
<span class="stinp">. graph export "box01.png", replace</span>
(file box01.png written in PNG format)
    </samp></pre>
            <div class="img-block">
                <img id="box01" src="" alt="">
            </div>
        </div>
        <div class="block">
            <h3 id="6-6">其他繪圖技巧</h3>
            <ol>
                <li>添加更多座標軸<br><code>twoway (,yaxis(2))</code>：為該圖形應用第二條座標軸，一張圖最多可有9條座標軸。</li>
                <li>設定圖的尺寸<br><code>xsize(10)</code>、<code>ysize(5)</code>：寬度為10英吋，高度為5英吋。</li>
                <li>添加文字<br><code>text(1 3 "abc", place(w) color(red))</code>：在y=1,x=3的地方加入文字「abc」，<code>place(w)</code>代表文字靠左，靠右為<code>e</code>，詳細可至此<a href="https://www.stata.com/manuals/g-3added_text_options.pdf" target="_blank">此處（<i>added_text_options</i>）</a>查看。</li>
                <li>標題
                    <ul>
                        <li><code>title("")</code>：表格主標題<br></li>
                        <li><code>subtitle("")</code>：副標題</li>
                        <li><code>xtitle("")</code>：X軸標題<br></li>
                        <li><code>ytitle("")</code>：Y軸標題<br></li>
                        <li><code>ytitle("", orientation(horizontal))</code>：橫向標題<br></li>
                        <li><code>ytitle("", height(-60))</code>：Y軸標題區塊高度-60，區塊變短，文字會向上移動<br></li>
                        <li><code>ytitle("", placement(nw))</code>：移動標題位置，<code>nw</code>代表左上角(north, west)，詳細位置看<a href="https://www.stata.com/manuals/g-3added_text_options.pdf#g-3added_text_optionsOptions">Options for adding text to twoway graphs</a></li>
                    </ul>
                </li>
                <li>設定刻度
                    <ul>
                        <li><code>xlabel(0(1)10)</code>、<code>ylabel(0(1)10)</code>：X或Y軸由0~10，每隔1畫一個刻度。<br></li>
                        <li><code>xlabel(1 "a" 2 "b")</code>：定義刻度名稱，在X=1的地方加上刻度，刻度名稱為a，在X=2加上刻度，刻度名稱為b。Y軸設定方法同上。</li>
                        <li><code>xlabel(, angle(45))</code>：旋轉刻度值45度，用於Y軸只須改為<code>ylable</code>。<br></li>
                        <li><code>ylabel(, axis(2))</code>：表示第二條座標軸適用這些設定。</li>
                    </ul>
                </li>
                <li>設定圖例
                    <ul>
                        <li><code>legend(label(1 "分類1") label(2 "分類2"))</code>：設定圖例名稱，Y變項有多個分類時可用，此處的1並非資料檔中的分類編碼，而是製作圖表時畫上去的順序。</li>
                        <li><code>legend(c(2))</code>：圖例內容兩兩並排(column = 2)，也可使用<code>r(#)</code># = 正整數</li>
                        <li><code>legend(pos(6))</code>：代表圖例出現的位置，以時鐘上的數字為方向。</li>
                        <li><code>legend(symx(*0.25))</code>：圖例尺寸，<code>*0.25</code>代表0.25倍。</li>
                    </ul>
                </li>
            </ol>
        </div>
    </div>
    <script>
        const requestURL = '../assets/js/json/data.json'
        const picsUrl = '../assets/js/json/pics/stata006.json'
    </script>
    <script src="../assets/js/main.js"></script>
</body>

</html>